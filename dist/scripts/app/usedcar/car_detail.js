define(function(require,exports,module){var $=require("zepto"),base=require("base"),wx=require("wechat");require("swipe"),$(function(){var staticMap,point,conten_width=$(".wrap").width(),coord_long=$(".dealer-til").data("coord-long"),coord_lat=$(".dealer-til").data("coord-lat"),marker=null,url=window.location.href;(coord_long||coord_lat)&&coord_long>100?(staticMap=new BMap.Map("static_map"),point=new BMap.Point(coord_long,coord_lat),marker=new BMap.Marker(point),staticMap.centerAndZoom(point,16),staticMap.addEventListener("tilesloaded",function(){staticMap.panTo(point),staticMap.addOverlay(marker),marker.setAnimation(BMAP_ANIMATION_BOUNCE)})):$("#view_map").hide(),320>conten_width?conten_width=320:conten_width>540&&(conten_width=540),$(".del-map").on("click",function(){$(".detail-map, .alpha").hide()}),$("#view_map").on("click",function(){$(".wrap").height($(".wrap").height()+360),$("#map_cover, #static_map").show(),ga("send","event","usedcar","click","map"),$(this).hide()}),$(".wrap").on("click",".return",function(){window.history.go(-1)}),$(".dealer-til").on("click",function(){$(this).data("url")&&(window.location.href="http://"+window.location.host+$(this).data("url"))}),$(document).scroll(function(){$(window).scrollTop()>600?"none"===$(".return-top").css("display")&&$(".return-top").show():$(".return-top").hide()}),$(".return-top").on("click",function(){$(window).scrollTop(0)}),$(document).on("orientationchange",function(){var e=$(".wrap").width();$(".swiper-container").width(e),$(".swiper-container").height(3*e/4),$(".swiper-container").css({"line-height":3*e/4+"px"}),$(".tel-fixed, .detail-map").width(e)}),$(".sub-visit").on("click",function(){$(".share-top").toggle()}),$(".swiper-container").width(conten_width),$(".swiper-container").height(3*conten_width/4),$(".swiper-container").css({"line-height":3*conten_width/4+"px"}),$(".tel-fixed, .detail-map").width(conten_width),$(".tel-fixed").show(),$("#footer").height(210),window.location.href.indexOf("channel")>-1&&$(".wrap").height($(".wrap").height()+40);new Swiper(".swiper-container",{grabCursor:!0,loop:!0,calculateHeight:!0,preloadImages:!0,updateOnImagesReady:!0,onInit:function(e){if(0!==e.imagesLoaded){var t=e.loopCreated===!1?e.imagesLoaded:e.imagesLoaded-2;0===t?$(".imgs-pagination").remove():$(".imgs-pagination").html("1<i>/</i>"+t).show(),$(".img-list img").show()}},onSlideChangeEnd:function(e){for(var t=$(".img-list").find("li"),i=0;i<t.length;i++){var n=t.eq(i).find("img"),a=t.eq(i).find("img").data("src");a&&(n.attr("src",a),n.removeAttr("data-src"))}},onSlideNext:function(e){var t=e.loopCreated===!1?e.imagesLoaded:e.imagesLoaded-2;e.loopCreated===!1?e.activeIndex+1===t?curNum=t:curNum=e.activeIndex+1:e.activeIndex>t?curNum=e.activeIndex-t:curNum=e.activeIndex,$(".imgs-pagination").html(curNum+"<i>/</i>"+t)},onSlidePrev:function(e){var t=e.loopCreated===!1?e.imagesLoaded:e.imagesLoaded-2;e.loopCreated===!1?e.activeIndex-1===0?curNum=1:curNum=e.activeIndex+1:0===e.activeIndex?curNum=t:curNum=e.activeIndex,$(".imgs-pagination").html(curNum+"<i>/</i>"+t)}});with($("img.lazy").lazyload({effect:"fadeIn",threshold:200,effectspeed:200}),window._bd_share_config={common:{bdText:$("#car_title").html(),bdDesc:$("#car_title").html(),bdUrl:window.location.href,bdPic:$(".img-list").find("img").eq(0).attr("src"),onBeforeClick:function(e,t){return"tsina"===e?t.bdText=$("#car_title").html()+" @第一车网二手车":"tqq"===e&&(t.bdText=$("#car_title").html()+" @第一车网"),t}},share:[{bdSize:16}]},document)0[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion="+~(-new Date/36e5)];var change_src=function(e){var t=e.substr(e.lastIndexOf("/"));return""!=t&&(new_last_src="/small"+t,e=e.replace(t,new_last_src)),e},share_wx=function(e){var t=e.data||{};wx.config(t),wx.ready(function(){var e={src:change_src($(".swiper-slide").eq(1).find("img").attr("src")),link:url,title:$("#car_title").text(),desc:$(".iautos").text()};wx.onMenuShareAppMessage({title:e.title,desc:e.desc,link:e.link,imgUrl:e.src,trigger:function(e){},success:function(e){},cancel:function(e){},fail:function(e){}}),wx.onMenuShareTimeline({title:e.title,link:e.link,imgUrl:e.src,trigger:function(e){},success:function(e){},cancel:function(e){},fail:function(e){}}),wx.onMenuShareQQ({title:e.title,desc:e.desc,link:e.link,imgUrl:e.src,trigger:function(e){},complete:function(e){},success:function(e){},cancel:function(e){},fail:function(e){}})})};base.common.getpData(base.address.wechat,"/?url="+url+"&callback=?",!1,"jsonp",share_wx,function(){}),$("#askprice-close").on("click",function(){base.utils.coverLayer.alphaEnd(),$("#askprice-box").hide()}),$("#low-ask").on("click",function(){$("#askprice-box").show(),$("#input-phone").focus()}),$("#sure-ask").on("click",function(){var e=new RegExp(/^(\+86)?(1[3,4,5,7,8][0-9]{9})$/),t=$("#input-phone").val();if(""==t){$("#phone-null").show();setTimeout(function(){$("#phone-null").hide()},1500);return!1}if(!e.test(t)){$("#phone-error").show();setTimeout(function(){$("#phone-error").hide()},1500);return!1}var i=$("#clueData").val();base.common.postData(base.address.usedcar_clue,"contact_phone="+t+"&clue_data="+i.toString(),!1,function(e){if(1==e){$("#info-change").show();setTimeout(function(){$("#info-change").hide()},2e3);return!1}if(17==e){$("#insert-repeat").show();setTimeout(function(){$("#insert-repeat").hide()},2e3);return!1}if(0==e){$("#insert-failt").show();setTimeout(function(){$("#insert-fail").hide()},2e3);return!1}$("#askprice-box").hide(),$("#askprice-success").show();setTimeout(function(){$("#askprice-success").hide(),base.utils.coverLayer.alphaEnd()},1e3);return!1},function(){})})})});