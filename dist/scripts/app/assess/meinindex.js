define(function(e,a,t){var s=e("zepto"),r=e("base"),n=e("render");s(function(){var a=e("{tpl_path}/static2015/template/area.tpl"),t={area:a};n.tpl("area_tpl",t);var o="",p="",l="";s(".speed").on("click","li",function(){0===s(this).index()?(r.utils.coverLayer.alphaStart(),s(".sub-visit").remove(),r.utils.webkitTransform("area_popup",[],function(){s("#content_part").hide(),s("#footer").hide(),r.utils.coverLayer.alphaEnd()})):1===s(this).index()&&(r.utils.coverLayer.alphaStart(),r.utils.webkitTransform("brand_popup",[],function(){s("#content_part").hide(),s("#footer").hide(),r.utils.coverLayer.alphaEnd()}))}),s(".area-main-count").on("click","li",function(){var e=s(this).attr("data-pinyin");s("#assess_area").html(s(this).html()),s("#assess_area").attr("data-pinyin",e),r.utils.webkitTransform("area_popup",["content_part","footer"],function(){s("#area_popup").hide()})}),s(".brand-title").on("click","li",function(){if(!s(this).hasClass("active")){var e=s(this).attr("data-quick").split(",");for(s(".brand-title li").removeClass("active"),s(this).addClass("active"),s(".brand-box").hide(),i=0;i<e.length;i++)s(".brand-box-"+e[i]).show()}}),s(".brand-main").on("click","li",function(){r.utils.coverLayer.alphaStart(),s.ajax({type:"GET",dataType:"json",async:!1,url:"http://"+window.location.host+r.address.assess.series+"/?brand_id="+s(this).attr("data-id"),success:function(e){var a="";for(var t in e.series){for(a+="<div class='line-box'><h2 class='glb-title'><span>"+t+"</span></h2><ul>",j=0;j<e.series[t].length;j++)a+="<li><a data-id='"+e.series[t][j].id+"'>"+e.series[t][j].name+"</a></li>";a+="</ul></div>"}s(".series-box").html(""),s(".series-box").append(a)},error:function(){}}),r.utils.webkitTransform("series_popup",[],function(){s("#brand_popup").hide(),s("#content_part").hide(),s("#footer").hide()}),r.utils.coverLayer.alphaEnd()}),s(".series-box").on("click","li",function(){o=s(this).find("a").attr("data-id"),r.utils.coverLayer.alphaStart(),s.ajax({type:"GET",dataType:"json",async:!1,url:"http://"+window.location.host+r.address.assess.year+"/?series_id="+o,success:function(e){var a="";for(i=0;i<e.length;i++)a+="<li data-year='"+e[i]+"'>"+e[i]+"年</li>";s(".select-year").html(""),s(".select-year").append(a)},error:function(){}}),r.utils.webkitTransform("year_popup",[],function(){s("#series_popup").hide(),s("#content_part").hide(),s("#footer").hide()}),r.utils.coverLayer.alphaEnd()}),s(".select-year").on("click","li",function(){l=s(this).attr("data-year"),r.utils.coverLayer.alphaStart(),s.ajax({type:"GET",dataType:"json",async:!1,url:"http://"+window.location.host+r.address.assess.model+"/?series_id="+o+"&purchase_year="+l,success:function(e){var a="<h2 class='list-title'><span class='name'>款式名称</span><span class='price'>新车价格</span></h2>";for(var t in e){a+="<h2 class='glb-title'><span>"+t+"</span></h2><ul class='list-car'>";for(var i in e[t])a+="<li><span class='name' data-id='"+e[t][i].id+"' data-sub-title='"+e[t][i].sub_title+"'>"+e[t][i].title+"</span><span class='price'>"+e[t][i].new_price+"万</span></li>";a+="</ul>"}s("#model_popup .assess-main").html(""),s("#model_popup .assess-main").append(a)},error:function(){}}),r.utils.webkitTransform("model_popup",[],function(){s("#year_popup").hide(),s("#content_part").hide(),s("#footer").hide()}),r.utils.coverLayer.alphaEnd()}),s("#model_popup .assess-main").on("click","li",function(){p=s(this).find("span").eq(0).attr("data-id");var e=s(this).find("span").eq(0).attr("data-sub-title");s(".table-cell").removeClass("table-null"),s(".table-cell").html(e),s(".table-cell").attr("data-id",p),r.utils.webkitTransform("model_popup",["content_part","footer"],function(){s("#model_popup").hide()})}),s("#quickAssessBtn").on("click",function(){var e=s("#assess_area").attr("data-pinyin")||"",a=s("#assess_km").val();p&&e?s.ajax({type:"GET",dataType:"json",async:!1,url:"http://"+window.location.host+r.address.assess.check+"/?model_simple_id="+p+"&province_py="+e+"&km="+a+"&purchase_year="+l,success:function(e){1===e.code&&(""!==e.price_new&&0!==e.price_new.length?(s(".new-car .m").html(e.price_new.price+"+"+e.price_new.tax+"(购置税)=<i>"+e.price_new.total+"万元</i>"),s(".new-car").show()):s(".new-car").hide(),""!==e.price_used&&0!==e.price_used.length?s("#assess_price .price").html(e.price_used.buying_price+"万元~"+e.price_used.selling_price+"万元"):(s("#assess_price").hide(),s("#assess_noprice").show()),e.url?(s(".see-car").html("查看“"+e.model.brand_name+" "+e.model.series_name+"”在售车源"),s(".see-car").data("url",e.url)):s(".see-car").hide(),s("#content_part").hide(),s("#assess_result").show())},error:function(){}}):(s(".question-center").find("i").html("请填写评估信息"),r.utils.coverLayer.tipsCover(s(".question-center"),"hint-not"))}),s("#reassessBtn").on("click",function(){s("#content_part").show(),s("#assess_result").hide()}),s(".see-car").on("click",function(){s(this).attr("data-url")&&(window.location.href=s(this).attr("data-url"))}),s(".wrap").on("click",".return",function(){"sub_page"===s(this).attr("data-parentid")?"none"!==s("#content_part").css("display")?window.location.href="/":(s("#content_part").show(),s("#assess_result").hide()):"area_popup"===s(this).attr("data-parentid")?r.utils.webkitTransform("area_popup",["content_part","footer"],function(){s("#area_popup").hide()}):"brand_popup"===s(this).attr("data-parentid")?r.utils.webkitTransform("brand_popup",["content_part","footer"],function(){s("#brand_popup").hide()}):"series_popup"===s(this).attr("data-parentid")&&"brand_popup"===s(this).attr("data-recoverid")?r.utils.webkitTransform("series_popup",["brand_popup"],function(){s("#series_popup").hide()}):"year_popup"===s(this).attr("data-parentid")&&"series_popup"===s(this).attr("data-recoverid")?r.utils.webkitTransform("year_popup",["series_popup"],function(){s("#year_popup").hide()}):"model_popup"===s(this).attr("data-parentid")&&"year_popup"===s(this).attr("data-recoverid")&&r.utils.webkitTransform("model_popup",["year_popup"],function(){s("#model_popup").hide()})})})});