define(function(t,i,a){var n=t("zepto"),e=t("juicer"),o=t("base"),r=null,s={tplRender:function(t,i){var a=e(n("#"+t).html(),i);n("#"+t)[0].outerHTML=a},initArea:function(){var i=t("{tpl_path}/static2015/template/area.tpl"),a={area:i};s.geoValidate(),s.tplRender("area_tpl",a),l.prototype=new c,l.prototype.constructor=l;var n=new l;n.commonEventBind(),n.tapCity(),n.headerEventBind(),n.footerEventBind()},geoValidate:function(){o.utils.getSessionStorage("gsta")||o.common.geoLocation()}},c=function(){this.commonEventBind=function(){n(".wrap").on("click",".return",function(t,i){var a=n(this).attr("data-parentid"),e=n(this).attr("data-recoverid")||["content_part","footer"];if(i){var r=i.split("=");o.utils.webkitTransform(r[1],e,function(){n("#"+r[1]).hide()}),t.stopPropagation()}else if(a)"sub_page"===a?window.history.go(-1):("string"==typeof e&&(e=Array.call(this,e)),o.utils.webkitTransform(a,e,function(){n("#"+a).hide()}));else{var s=o.utils.queryUrlExtraData();""==s?window.location.href="/":window.location.href="/?"+s}}),n(".sub-visit").on("click",function(t){if("A"!==t.target.nodeName){var i=n(this).attr("data-type");if("car_pick"===i||"news_more"===i)"none"===n("#"+i).css("display")?o.utils.fade(n("#"+i),"in",100):o.utils.fade(n("#"+i),"out",100);else if("area_choice"===i)n.fn.cookie("parea",n(this).attr("data-pinyin"),{path:"/"}),n(".head-area").html(n(this).html()+'<i class="ico1"></i>'),o.common.redirectProcessor(n(this).attr("data-pinyin"))||n(".return").trigger("click","fast=area_popup");else if("question_commit"===i){var a=(n(this).parents(".comment-box").siblings("p").eq(2),n(this).data("action")),e=null;"reply"===a?e=n(this).siblings("textarea"):"question"===a&&(e=n("#questionContent")),"reply"===a?e.val().length<2?(""===e.val()?n(".hint-not i").html("请输入评论内容"):n(".hint-not i").html("评论内容描述至少2个字"),o.utils.coverLayer.tipsCover(n(".question-center"),"hint-not")):o.common.postData(o.address.comment_commit,"content="+e.val()+"&reply_id="+e.attr("data-replyid")+"&parent_id="+e.attr("data-parentid"),!1,function(t){1===t.code?(o.utils.coverLayer.tipsCover(n(".question-center"),"hint-ok"),setTimeout(function(){window.location.reload()},2e3)):2===t.code&&(o.utils.coverLayer.alphaStart(!1),o.utils.fade(n("#questionValidate"),"in"))},function(){}):"question"===a&&(e.val().length<7?(""===e.val()?n(".hint-not i").html("请输入问题内容"):n(".hint-not i").html("问题内容描述至少6个字"),o.utils.coverLayer.tipsCover(n(".question-center"),"hint-not")):o.common.postData(o.address.question_commit,"title="+n("#questionContent").val(),!1,function(t){1===t.code?(o.utils.coverLayer.tipsCover(n(".question-center"),"hint-ok"),setTimeout(function(){window.history.go(-1)},2e3)):2===t.code&&(o.utils.coverLayer.alphaStart(!1),o.utils.fade(n("#questionValidate"),"in"))},function(){}))}}}),n(document).scroll(function(){n(window).scrollTop()>600?"none"===n(".return-top").css("display")&&n(".return-top").show():n(".return-top").hide()}),n(".return-top").on("click",function(){n(window).scrollTop(0)})}},l=function(){this.tapCity=function(){n(".area-main-count li").on("click",function(t){var i=n(this).data("pinyin");if(n.inArray(i,["beijing","tianjin","chongqing","shanghai"])>-1){var a=n(this).attr("data-pinyin");n.fn.cookie("parea",n(this).attr("data-pinyin"),{path:"/"}),n(".head-area").html(n(this).html()+'<i class="ico1"></i>'),o.common.redirectProcessor(a)||n(".return").trigger("click","fast=area_popup")}else if(0===n(this).find(".triangle").length){var e="<div class='area-sub  sub-dashed' style='top:"+(parseInt(n(this).offset().top)+37)+"px'><ul>",r=n(this).attr("data-pinyin"),s=o.areaData.city[r];n(".triangle").remove(),n(this).append("<span class='triangle'></span>");for(var c=0;c<s.length;c++)e+="<li data-pinyin='"+s[c].pinyin+"'>"+s[c].name+"</li>";e+="<li>全部</li></ul></div>",n(".area-sub").remove(),n(n(this).parents("div")[0]).after(e)}else n(".triangle").remove(),n(".area-sub").remove()}),n(".select-area").on("click",".area-sub li",function(t,i){var a=n(this).attr("data-pinyin");a?(n.fn.cookie("parea",n(this).attr("data-pinyin"),{path:"/"}),n(".head-area").html(n(this).html()+'<i class="ico1"></i>')):(a=n(".triangle").parent().attr("data-pinyin"),n.fn.cookie("parea",a,{path:"/"}),n(".head-area").html(n(".triangle").parent().text()+'<i class="ico1"></i>')),o.common.redirectProcessor(a)||n(".return").trigger("click","fast=area_popup")})},this.tapProvince=function(){n(".area-main-count li").on("click",function(){n("#assess_area").html(n(this).html()),n("#assess_area").attr("data-pinyin",n(this).attr("data-pinyin")),o.common.redirectProcessor(n(this).attr("data-pinyin"))||n(".return").trigger("click","fast=area_popup")})},this.headerEventBind=function(){var t=function(t){var i="",a=n("#searchTip").attr("data-url");n.each(t,function(t,n){if(a.indexOf("?")>-1)var e=a+"&kw="+n.name;else var e=a+"?kw="+n.name;i+='<li data-url="'+e+'"><span class="fl">'+n.name+'</span><span class="fr">约<i>'+n.count+"</i>个结果</span></li>"}),n("#searchTip").html(i),n("#searchTip li").on("click",function(){n(this).addClass("active"),window.location.href=n(this).attr("data-url")})};n(".head-area").on("click",function(t){o.utils.webkitTransform("area_popup",[],function(){n("#content_part").hide(),n("#footer").hide()})}),n(".index-head h1").on("click",function(){var t=o.utils.queryUrlExtraData();""==t?window.location.href="/":window.location.href="/?"+t}),n(".head-search").on("click",function(){o.utils.webkitTransform("search_popup",[],function(){n("#content_part").hide(),n("#footer").hide()}),ga("send","event","home1","click","搜索")}),n(".inx-visit").on("click",function(){o.utils.coverLayer.alphaStart(!1),o.utils.webkitTransform("login_popup",[],function(){}),ga("send","event","all","click","list view")}),n(".alpha").on("click",function(){"block"==n("#login_popup").css("display")&&(o.utils.coverLayer.alphaEnd(),o.utils.webkitTransform("login_popup",["temp"],function(){n("#login_popup").hide()}))}),n(".login-popup-ico").on("click",function(){o.utils.coverLayer.alphaEnd(),o.utils.webkitTransform("login_popup",["temp"],function(){n("#login_popup").hide()}),ga("send","event","all","click","list back")}),n("#inputSearch").on("input",function(i){clearTimeout(r),r=setTimeout(function(){""!==n("#inputSearch").val()?(o.utils.fade(n("#searchTip"),"in",200),o.common.getData(o.address.site_autocomplete,"?q="+n("#inputSearch").val(),!1,t,function(){})):n("#searchTip li").removeClass("active")},200)})},this.footerEventBind=function(){o.utils.getSessionStorage("__app_d_cancel")||(/(Android)/i.test(navigator.userAgent)?(n(".client-box .dow-ico1").attr("data-alias","_a"),n(".client-box").show()):(n(".client-box .dow-ico1").attr("data-alias","_i"),n(".client-box").show())),n(".client-box .dow-ico1").on("click",function(){"_i"===n(this).data("alias")?window.location.href="https://itunes.apple.com/cn/app/di-yi-che-wang-zhuan-ye-er/id1058776547?mt=8":"_a"===n(this).data("alias")&&(window.location.href="http://api.99haoche.com/99haoche-api/appDownload?name=99haoche&system=android&channel=0 ")}),n(".client-box .del").on("click",function(t){o.utils.setSessionStorage("__app_d_cancel",!0),n(".client-box").hide(),t.stopPropagation()})}};i.init=s.initArea,i.tpl=s.tplRender,i.events={common:c,header:l}});